import pytest

from utility_lib.file_utilities.csv_utililities import write_list_to_csv


@pytest.fixture(scope="function")
def csv_test_data(tmp_path):
    # TODO make some test data here for collect_paths and delta_paths
    test_data_root_dir = tmp_path / "csv_test_data"
    test_data_root_dir.mkdir(exist_ok=True)
    data = {"test_dir": test_data_root_dir, "test_data": test_data()}
    return data


def test_lists_to_csv(csv_test_data):
    file_path = csv_test_data["test_dir"] / "csv_from_lists.csv"
    count = write_list_to_csv(csv_test_data["test_data"], file_path)
    print(file_path)
    assert count == 12


def test_data():
    data = [
        [
            "duration",
            "is_buy_order",
            "issued",
            "location_id",
            "min_volume",
            "order_id",
            "price",
            "range",
            "system_id",
            "type_id",
            "volume_remain",
            "volume_total",
        ],
        [
            "90",
            "True",
            "2019-12-01T10:49:59Z",
            60004099,
            1,
            5554953115,
            1.0,
            "region",
            30002779,
            14021,
            1000,
            1000,
        ],
        [
            "90",
            "True",
            "2019-12-12T14:57:22Z",
            60004327,
            1,
            5562948518,
            0.03,
            40,
            30002751,
            266,
            1000,
            1000,
        ],
        [
            "90",
            "True",
            "2019-12-12T14:56:36Z",
            1025026043977,
            1,
            5541845956,
            2500013.97,
            5,
            30002782,
            25625,
            10,
            20,
        ],
        [
            "90",
            "True",
            "2019-11-09T23:08:53Z",
            1025026043977,
            1,
            5489155023,
            900.15,
            "region",
            30002782,
            28367,
            12000,
            12000,
        ],
        [
            "90",
            "True",
            "2019-10-02T17:25:33Z",
            60004099,
            1,
            5516155873,
            1.0,
            "region",
            30002779,
            33101,
            995,
            1000,
        ],
        [
            "90",
            "True",
            "2019-12-05T13:55:30Z",
            60015008,
            1,
            5520663950,
            4.36,
            1,
            30041392,
            34,
            3495793,
            60000000,
        ],
        [
            "90",
            "True",
            "2019-12-08T19:13:08Z",
            60001618,
            1,
            5560458256,
            1.0,
            "region",
            30002770,
            1228,
            124437,
            124758,
        ],
        [
            "90",
            "True",
            "2019-10-23T17:33:02Z",
            60004099,
            1,
            5528738856,
            1.0,
            "region",
            30002779,
            33475,
            10,
            10,
        ],
        [
            "365",
            "True",
            "2019-12-12T22:29:48Z",
            60000322,
            1,
            911203378,
            120.73,
            "station",
            30002744,
            3673,
            70376,
            70376,
        ],
        [
            "365",
            "True",
            "2019-12-12T22:29:48Z",
            60000325,
            1,
            911203379,
            120.73,
            "station",
            30002746,
            3673,
            70376,
            70376,
        ],
        [
            "365",
            "True",
            "2019-12-12T22:29:48Z",
            60000328,
            1,
            911203380,
            120.73,
            "station",
            30002748,
            3673,
            70376,
            70376,
        ],
        [
            "365",
            "True",
            "2019-12-12T22:29:48Z",
            60000331,
            1,
            911203381,
            120.73,
            "station",
            30002748,
            3673,
            70376,
            70376,
        ],
    ]
    return data

